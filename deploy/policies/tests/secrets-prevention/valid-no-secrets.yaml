---
# VALID: Pod with no hardcoded secrets
apiVersion: v1
kind: Pod
metadata:
  name: test-no-secrets-valid
  namespace: ai-agents-dev
  labels:
    app: test-agent
    tier: "2"
    framework-version: "2.1.0"
spec:
  serviceAccountName: tier-2-dev-sa
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
  containers:
  - name: agent
    image: nginx:1.21
    env:
    - name: LOG_LEVEL
      value: "info"
    - name: ENVIRONMENT
      value: "development"
    # CORRECT: Using valueFrom to reference secrets
    - name: API_KEY
      valueFrom:
        secretKeyRef:
          name: agent-secrets
          key: api-key
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 2
        memory: 4Gi
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop: ["ALL"]
      readOnlyRootFilesystem: true
